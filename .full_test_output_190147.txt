
   PASS  Tests\Unit\Documentation\DocumentationTest
  ✓ readme documents migration, seeding, and admin workspace commands    0.37s  
  ✓ runbook highlights admin urls and database commands

   PASS  Tests\Unit\ExampleTest
  ✓ that true is true                                                    0.19s  

   PASS  Tests\Unit\ListingDaysOnMarketTest
  ✓ it derives days on market from the listed_at timestamp               8.05s  
  ✓ it falls back to the stored value when listed_at is missing          0.18s  
  ✓ it never returns negative values when listed_at is in the future     0.18s  

   PASS  Tests\Unit\Models\ListingMediaPublicUrlTest
  ✓ it returns storage url when stored_path is present                   0.86s  
  ✓ it falls back to preview then url when not stored                    0.30s  

   PASS  Tests\Unit\Policies\ListingPolicyTest
  ✓ it allows admins to administer listings                              0.42s  
  ✓ it prevents subscribers from administering listings                  0.20s  
  ✓ it denies suspended admins from administering listings               0.17s  

   PASS  Tests\Unit\Policies\UserPolicyTest
  ✓ it allows admins to manage user records                              0.18s  
  ✓ it prevents subscribers from administering user records              0.17s  
  ✓ it prevents administrators from deleting or suspending themselves    0.17s  
  ✓ it denies suspended admins from managing user records                0.17s  

   PASS  Tests\Feature\Admin\ListingsPageTest
  ✓ guests are redirected from the listings index                        0.85s  
  ✓ authenticated users can browse, filter, and preview listings        32.21s  
  ✓ admins can suppress and unsuppress listings with audit logging       4.49s  
  ✓ admins can purge all listings                                        2.32s  
  ✓ admins can generate fake listings for testing                        2.08s  

   PASS  Tests\Feature\Auth\AuthenticationTest
  ✓ login screen can be rendered                                         1.86s  
  ✓ users can authenticate using the login screen                        1.14s  
  ✓ admins are redirected to the dashboard after login                   0.93s  
  ✓ users can not authenticate with invalid password                     1.05s  
  ✓ suspended users can not authenticate                                 1.07s  
  ✓ users forced to rotate their password receive a reset alert on failed login 1.04s  
  ✓ users with two factor enabled are redirected to two factor challenge 0.88s  
  ✓ users can logout                                                     0.17s  

   PASS  Tests\Feature\Auth\EmailVerificationTest
  ✓ email verification screen can be rendered                            0.41s  
  ✓ email can be verified                                                0.26s  
  ✓ email is not verified with invalid hash                              0.24s  
  ✓ already verified user visiting verification link is redirected without firing event again 0.19s  

   PASS  Tests\Feature\Auth\PasswordConfirmationTest
  ✓ confirm password screen can be rendered                              0.62s  

   PASS  Tests\Feature\Auth\PasswordResetTest
  ✓ reset password link screen can be rendered                           0.58s  
  ✓ reset password link can be requested                                 0.90s  
  ✓ reset password screen can be rendered                                1.05s  
  ✓ password can be reset with valid token                               1.29s  

   PASS  Tests\Feature\Auth\RegistrationTest
  ✓ registration screen can be rendered                                  0.70s  
  ✓ new users can register                                               1.06s  

   PASS  Tests\Feature\Auth\TwoFactorChallengeTest
  ✓ two factor challenge redirects to login when not authenticated       0.20s  
  ✓ two factor challenge can be rendered                                 0.90s  

   PASS  Tests\Feature\Console\ListingMediaBackfillTest
  ✓ it queues and syncs media for listings                               0.75s  

   PASS  Tests\Feature\Console\ListingMediaPruneTest
  ✓ it lists and deletes orphan media files                              0.42s  

   PASS  Tests\Feature\DashboardTest
  ✓ guests are redirected from the dashboard                             0.30s  
  ✓ subscribers cannot access the dashboard when an admin exists         0.23s  
  ✓ admins can view the dashboard                                        3.72s  
  ✓ dashboard displays analytics metrics when connected to google analytics 1.35s  
  ✓ dashboard surfaces a helpful message when analytics data is unavailable 1.63s  
  ✓ client tracking snippet is injected when enabled                     2.41s  

   PASS  Tests\Feature\DatabaseSeederTest
  ✓ database seeder creates at least 100 listings                        0.53s  

   PASS  Tests\Feature\ExampleTest
  ✓ returns a successful response                                        1.09s  

   PASS  Tests\Feature\HomepageComprehensiveTest
  ✓ it renders core homepage sections                                    1.19s  
  ✓ it shows a helpful state when idx is enabled but no listings are returned 1.16s  
  ✓ it recovers gracefully when idx fetch throws and still renders the page 1.16s  
  ✓ it falls back to active listings when PoS results are empty and fallback is enabled 1.21s  

   PASS  Tests\Feature\HomepageIdxListingsTest
  ✓ it displays idx listings when available                              1.18s  
  ✓ it shows guidance when idx credentials are missing                   1.10s  

   WARN  Tests\Feature\HomepageLiveIdxFeedTest
  - it renders the live idx feed on the homepage → Set RUN_LIVE_IDX_TESTS=1 to enable live homepage IDX test. 0.42s  

   WARN  Tests\Feature\IdxApiPowerOfSaleSmokeTest
  - it fetches power of sale listings live → Set RUN_LIVE_IDX_TESTS=1 to enable live IDX smoke tests. 0.18s  

   WARN  Tests\Feature\IdxApiSmokeTest
  - it fetches property data from the idx api → Set RUN_LIVE_IDX_TESTS=1 to enable live IDX smoke tests. 0.18s  
  - it fetches media data (images) from the idx api → Set RUN_LIVE_IDX_TESTS=1 to enable live IDX smoke tests. 0.19s  
  - it service attaches image_url to demo listings → Set RUN_LIVE_IDX_TESTS=1 to enable live IDX smoke tests. 0.18s  

   PASS  Tests\Feature\IdxClientFiltersActiveListingsTest
  ✓ it returns only live listings using StandardStatus                   0.21s  

   PASS  Tests\Feature\IdxClientMediaRequestSelectTest
  ✓ it composes Media request with $select and stable $orderby           0.17s  

   PASS  Tests\Feature\IdxClientRequestShapeTest
  ✓ it composes Property request with $select and stable $orderby        0.18s  

   PASS  Tests\Feature\ImportFeedsSourcePriorityTest
  ✓ it upgrades VOW to IDX when both present                             0.22s  
  ✓ it keeps IDX when VOW ingests after                                  0.17s  

   PASS  Tests\Feature\Jobs\BackfillListingMediaTest
  ✓ it dispatches media sync jobs for listings missing media             0.25s  

   PASS  Tests\Feature\Jobs\DownloadListingMediaTest
  ✓ it downloads and stores listing media                                0.26s  

   PASS  Tests\Feature\Jobs\ImportCursorClampingTest
  ✓ replication cursor never advances into the future                    0.30s  

   PASS  Tests\Feature\Jobs\ImportIdxPowerOfSaleTest
  ✓ it imports power of sale listings end-to-end                         0.34s  
  ✓ it updates existing listing matched by board_code + mls_number without duplicate 0.21s  
  ✓ it follows @odata.nextLink pagination when provided                  0.22s  
  ✓ it updates a soft-deleted duplicate instead of inserting a new row   0.19s  
  ✓ it does not append status history when import payload is unchanged   0.20s  

   PASS  Tests\Feature\Jobs\ImportVowPowerOfSaleTest
  ✓ it normalizes long board names to short codes in VOW import          0.20s  

   PASS  Tests\Feature\ListingSchemaTest
  ✓ it creates the listings table with expected columns                  0.18s  
  ✓ it creates the sources table with expected columns                   0.18s  
  ✓ it creates the municipalities table with expected columns            0.18s  
  ✓ it creates the listing status history table with expected columns    0.17s  
  ✓ it creates the saved searches table with expected columns            0.17s  
  ✓ it creates the audit logs table with expected columns                0.17s  
  ✓ it persists listings with related media via factories                0.20s  
  ✓ it maps payload data into canonical listing records                  0.22s  

   WARN  Tests\Feature\Live\LongLiveImportBothTest
  - it runs a full live import and surfaces listings + media (URLs only) → Set RUN_LONG_LIVE_IDX_TESTS=1 to enable full live import test. 0.19s  

   PASS  Tests\Feature\Livewire\Admin\Feeds\ButtonsExplicitTest
  ✓ test connection button loads preview and shows notice                1.39s  
  ✓ refresh preview clears cache and reloads preview                     1.28s  
  ✓ idx and vow probe buttons populate status details                    1.43s  

   FAIL  Tests\Feature\Livewire\Admin\Feeds\CancelAndDedupTest
  ✓ cancel queued imports removes matching jobs and shows a notice       0.98s  
  ⨯ import both does not queue when running or already queued            1.06s  

   PASS  Tests\Feature\Livewire\Admin\Feeds\ImportAllFromComponentTest
  ✓ import all button imports listings and marks progress completed      1.03s  
  ✓ import all shows completed with 0 items when no results are returned 0.97s  
  ✓ import both shows a visible import queued notice                     1.57s  
  ✓ import both also queues media backfill job                           0.91s  
  ✓ import both imports listings and media                               0.97s  

   PASS  Tests\Feature\Livewire\Admin\Feeds\ImportBothEndToEndTest
  ✓ it resets cursors and imports even when prior runs advanced the cursor 0.99s  

   PASS  Tests\Feature\Livewire\Admin\Feeds\ImportBothFiveWithImagesTest
  ✓ import both imports five listings with images and pages are reachable 4.67s  

   PASS  Tests\Feature\Livewire\Admin\Feeds\ImportCriticalFieldsNotNullTest
  ✓ critical listing fields are never null after import                  1.12s  

   PASS  Tests\Feature\Livewire\Admin\Feeds\ImportStoresFullPublicRemarksTest
  ✓ import stores full public remarks without truncation                 1.01s  

   PASS  Tests\Feature\Livewire\Admin\Feeds\IndexTest
  ✓ guests are redirected from the data feeds page                       0.17s  
  ✓ subscribers cannot access the data feeds page                        0.22s  
  ✓ admins can view the data feeds page                                  1.85s  

   PASS  Tests\Feature\Livewire\Admin\Feeds\StaleRunningProgressAllowsQueueTest
  ✓ stale running progress does not block importBoth when queue is idle  1.00s  

   PASS  Tests\Feature\Livewire\Admin\Listings\ShowTest
  ✓ guests are redirected from the listing detail view                   0.19s  
  ✓ subscribers cannot access the listing detail view when an admin exists 0.22s  
  ✓ admins can review listing metadata, photos, and change history       1.80s  

   PASS  Tests\Feature\Livewire\Admin\Settings\AnalyticsSettingsTest
  ✓ it renders the analytics settings page for administrators            1.58s  
  ✓ it allows administrators to enable both client and server analytics  1.62s  
  ✓ it requires a property id when enabling server metrics               1.58s  
  ✓ it validates service account credentials structure                   1.53s  
  ✓ it requires a measurement id when any integration toggle is enabled  1.10s  
  ✓ it allows enabling client tracking without server credentials        1.12s  

   PASS  Tests\Feature\Livewire\Admin\Users\IndexTest
  ✓ guests are redirected from the users index                           0.19s  
  ✓ subscribers cannot access the admin users index                      0.22s  
  ✓ admins can browse, update roles, and remove subscriber accounts      5.46s  
  ✓ administrators cannot delete their own accounts via the admin workspace 1.97s  
  ✓ admins can invite new subscribers and send reset links               3.01s  
  ✓ admins can trigger password reset emails for existing users          2.34s  
  ✓ admins can force credential rotations for users                      2.35s  
  ✓ admins can suspend and reactivate users                              2.64s  
  ✓ admins cannot trigger additional actions while processing another    3.31s  
  ✓ users index renders a processing indicator for privileged actions    1.20s  
  ✓ the final active admin cannot be demoted or suspended via the workspace 2.75s  
  ✓ the first authenticated user is promoted to admin when no admins exist 2.22s  

   PASS  Tests\Feature\ProcessListingPayloadTest
  ✓ it processes payloads via queued job and normalises data             0.22s  

   PASS  Tests\Feature\PublicListingsTest
  ✓ guests can browse current listings                                   1.13s  
  ✓ listings pagination links are rendered                               1.37s  
  ✓ guests can view a listing detail page                                1.14s  
  ✓ suppressed listings are hidden from the public catalog               1.95s  

   PASS  Tests\Feature\Services\Idx\IdxClientCachingTest
  ✓ it caches listing results to avoid repeated network calls            0.20s  

   PASS  Tests\Feature\Services\Idx\IdxClientTest
  ✓ example                                                              1.17s  

   PASS  Tests\Feature\Services\Idx\ListingTransformerTest
  ✓ it transforms listing payload with sensible fallbacks                0.18s  

   PASS  Tests\Feature\Settings\PasswordUpdateTest
  ✓ password can be updated                                              1.08s  
  ✓ correct password must be provided to update password                 1.08s  

   PASS  Tests\Feature\Settings\ProfileUpdateTest
  ✓ profile page is displayed                                            1.51s  
  ✓ subscriber does not see admin navigation links                       1.41s  
  ✓ profile information can be updated                                   1.02s  
  ✓ email verification status is unchanged when email address is unchanged 1.02s  
  ✓ user can delete their account                                        0.63s  
  ✓ correct password must be provided to delete account                  0.74s  

   PASS  Tests\Feature\Settings\TwoFactorAuthenticationTest
  ✓ two factor settings page can be rendered                             1.41s  
  ✓ two factor settings page requires password confirmation when enabled 0.17s  
  ✓ two factor settings page returns forbidden response when two factor is disabled 0.22s  
  ✓ two factor authentication disabled when confirmation abandoned between requests 0.75s  

   PASS  Tests\Feature\Volt\AdminFeedsPageTest
  ✓ it requires authentication                                           0.20s  
  ✓ it renders admin feeds page                                          1.77s  

   PASS  Tests\Feature\Volt\AdminFeedsQueuedNoticeVisibilityTest
  ✓ it shows queued notice prominently and with at least 10s visibility  1.92s  

   PASS  Tests\Feature\WelcomePageProgressTest
  ✓ it shows milestone progress aligned with the task list               1.14s  
  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Feature\Livewire\Admin\Feeds\CancelAndDedupTest > import both does not queue when running or already queued   
  The unexpected [App\Jobs\ImportAllPowerOfSaleFeeds] job was dispatched.
Failed asserting that false is true.

  at vendor/laravel/framework/src/Illuminate/Support/Testing/Fakes/BusFake.php:190
    186▕         if ($command instanceof Closure) {
    187▕             [$command, $callback] = [$this->firstClosureParameterType($command), $command];
    188▕         }
    189▕ 
  ➜ 190▕         PHPUnit::assertTrue(
    191▕             $this->dispatched($command, $callback)->count() === 0 &&
    192▕             $this->dispatchedAfterResponse($command, $callback)->count() === 0 &&
    193▕             $this->dispatchedSync($command, $callback)->count() === 0,
    194▕             "The unexpected [{$command}] job was dispatched."

  1   vendor/laravel/framework/src/Illuminate/Support/Testing/Fakes/BusFake.php:190
  2   vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php:363
  3   tests/Feature/Livewire/Admin/Feeds/CancelAndDedupTest.php:58


  Tests:    1 failed, 6 skipped, 141 passed (588 assertions)
  Duration: 184.03s

